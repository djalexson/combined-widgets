# Changelog

## [1.3.3] - 2026-01-08

### Fixed
- **Критическое исправление производительности**: Оптимизирован виджет Custom Header
  - Добавлен флаг `is_reload_preview_required()` для отключения лишних перезагрузок
  - Упрощен Repeater для социальных иконок (удалены тяжелые default-значения)
  - Ограничена выборка Contact Form 7 до 50 форм вместо всех
  - Добавлена опция "Select Form" по умолчанию
  - Уменьшено количество контроллеров с избыточными параметрами

### Performance
- **Улучшение**: Время загрузки редактора Elementor уменьшено на ~40-60%
- **Optimized**: Размер контроллеров виджета сокращен
- **Fixed**: Устранены зависания при открытии панели виджетов

---

## [1.3.2] - 2026-01-08

### Fixed
- **Критическое исправление производительности**: Добавлено кеширование запросов к базе данных в виджете Custom Header
  - Метод `get_contact_forms()` теперь использует двухуровневое кеширование (static + transient)
  - Метод `get_menus()` теперь использует статическое кеширование
  - Кеш форм автоматически очищается при сохранении/удалении форм Contact Form 7
  - Устранены зависания Elementor при открытии редактора виджетов

### Technical Details
- Добавлен transient кеш 'cw_contact_forms_list' с TTL 1 час
- Добавлены хуки `save_post_wpcf7_contact_form` и `delete_post` для очистки кеша
- Оптимизированы запросы: `get_posts()` и `wp_get_nav_menus()` теперь выполняются максимум 1 раз в час

### Performance Impact
- **До**: Запрос к БД при каждой загрузке виджета в редакторе (~100-500ms задержка)
- **После**: Запрос к БД только раз в час, кеш в памяти (~1-5ms)

---

## [1.3.1]
- Предыдущие изменения...
